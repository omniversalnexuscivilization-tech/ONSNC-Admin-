<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>UH-MDARC Dashboard</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
  <style>
:root {
  --primary-dark: #0A0E27;
  --primary-deep: #1A1F3A;
  --accent-cyan: #00D9FF;
  --accent-purple: #B24BF3;
  --glass-bg: rgba(255, 255, 255, 0.05);
  --glass-border: rgba(255, 255, 255, 0.1);
  --font-primary: 'Inter', system-ui, sans-serif;
}

* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  font-family: var(--font-primary);
  background: linear-gradient(135deg, #0A0E27 0%, #1A1F3A 50%, #2D3561 100%);
  background-attachment: fixed;
  color: #E8EAF6;
  min-height: 100vh;
  line-height: 1.6;
}

.wrap {
  max-width: 1600px;
  margin: 0 auto;
  padding: 20px;
}

.top {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 30px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.header-content {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
}

.logo-section {
  display: flex;
  align-items: center;
  gap: 15px;
}

.logo-icon {
  font-size: 2.5rem;
  background: linear-gradient(90deg, #00D9FF, #B24BF3);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.top h1 {
  font-size: 1.75rem;
  background: linear-gradient(90deg, #00D9FF, #B24BF3);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.muted {
  color: #94A3B8;
  font-size: 0.875rem;
  margin-top: 4px;
}

.top-actions {
  display: flex;
  gap: 10px;
}

.btn {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 12px 20px;
  border: none;
  border-radius: 12px;
  font-size: 0.875rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
}

.btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
}

.btn.primary {
  background: linear-gradient(135deg, #00D9FF, #0099CC);
  color: white;
}

.btn.secondary {
  background: linear-gradient(135deg, #B24BF3, #8B3BC7);
  color: white;
}

.btn.danger {
  background: linear-gradient(135deg, #EF4444, #DC2626);
  color: white;
}

.content {
  display: grid;
  grid-template-columns: 1fr 450px;
  gap: 30px;
}

.panel {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
  padding: 30px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.panel h2 {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 25px;
  font-size: 1.5rem;
  color: #E8EAF6;
  padding-bottom: 15px;
  border-bottom: 1px solid var(--glass-border);
}

.panel h2 i {
  color: var(--accent-cyan);
}

.panel h3 {
  display: flex;
  align-items: center;
  gap: 10px;
  margin: 25px 0 15px;
  font-size: 1.125rem;
  color: #E8EAF6;
}

.panel h3 i {
  color: var(--accent-purple);
}

.section-divider {
  margin: 30px 0 20px;
  text-align: center;
  position: relative;
}

.section-divider::before,
.section-divider::after {
  content: '';
  position: absolute;
  top: 50%;
  width: calc(50% - 120px);
  height: 1px;
  background: var(--glass-border);
}

.section-divider::before { left: 0; }
.section-divider::after { right: 0; }

.section-divider span {
  display: inline-block;
  padding: 8px 20px;
  background: var(--primary-deep);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
  font-size: 0.8125rem;
  font-weight: 600;
  color: var(--accent-cyan);
  text-transform: uppercase;
}

.form-grid {
  display: grid;
  gap: 15px;
}

.form-grid.two {
  grid-template-columns: repeat(2, 1fr);
}

.form-group {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.form-group label {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.875rem;
  font-weight: 500;
  color: #CBD5E1;
}

.form-group label i {
  color: var(--accent-cyan);
}

input[type="text"],
input[type="date"],
input[type="number"],
textarea {
  width: 100%;
  padding: 12px;
  background: rgba(15, 23, 42, 0.6);
  border: 1px solid var(--glass-border);
  border-radius: 12px;
  color: #E8EAF6;
  font-family: var(--font-primary);
  font-size: 0.875rem;
  transition: all 0.3s ease;
}

input:focus, textarea:focus {
  outline: none;
  border-color: var(--accent-cyan);
  box-shadow: 0 0 0 3px rgba(0, 217, 255, 0.1);
}

textarea {
  min-height: 100px;
  resize: vertical;
}

.profile-section {
  display: flex;
  gap: 20px;
  margin-bottom: 25px;
}

.photo-upload {
  width: 120px;
  height: 120px;
  border-radius: 12px;
  background: rgba(15, 23, 42, 0.6);
  border: 2px dashed var(--glass-border);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  cursor: pointer;
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.photo-upload:hover {
  border-color: var(--accent-cyan);
}

.photo-overlay {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  color: #94A3B8;
}

.photo-overlay i {
  font-size: 2rem;
}

.photo-preview {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: none;
}

.photo-preview.active {
  display: block;
}

.profile-info {
  flex: 1;
}

.qr-section {
  display: flex;
  gap: 20px;
  padding: 20px;
  background: rgba(15, 23, 42, 0.4);
  border: 1px solid var(--glass-border);
  border-radius: 12px;
  margin-top: 20px;
}

.qr-code {
  width: 100px;
  height: 100px;
  padding: 8px;
  background: white;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.qr-code canvas {
  max-width: 100%;
  max-height: 100%;
}

.ulci-section {
  margin-top: 25px;
  padding: 20px;
  background: rgba(15, 23, 42, 0.6);
  border: 1px solid var(--glass-border);
  border-radius: 12px;
}

.ulci-dashboard {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 15px;
  margin-bottom: 20px;
}

.ulci-badge {
  display: flex;
  align-items: center;
  gap: 15px;
  padding: 15px;
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid var(--glass-border);
  border-radius: 12px;
}

.badge-icon {
  width: 50px;
  height: 50px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, #00D9FF, #B24BF3);
  border-radius: 12px;
  font-size: 1.5rem;
  color: white;
}

.badge-content .label {
  font-size: 0.75rem;
  color: #94A3B8;
  text-transform: uppercase;
}

.badge-content .value {
  font-size: 1.25rem;
  font-weight: 700;
  color: #E8EAF6;
}

.dimension-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
  margin: 20px 0;
}

.dimension-card {
  padding: 20px;
  background: rgba(15, 23, 42, 0.6);
  border: 1px solid var(--glass-border);
  border-radius: 12px;
  transition: all 0.3s ease;
}

.dimension-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 12px 30px rgba(0, 0, 0, 0.4);
}

.dimension-icon {
  width: 50px;
  height: 50px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 12px;
  font-size: 1.5rem;
  margin-bottom: 15px;
}

.dimension-icon.lmi {
  background: linear-gradient(135deg, #3B82F6, #1E40AF);
  color: white;
}

.dimension-icon.eci {
  background: linear-gradient(135deg, #EF4444, #DC2626);
  color: white;
}

.dimension-icon.ci {
  background: linear-gradient(135deg, #10B981, #059669);
  color: white;
}

.dimension-icon.ras {
  background: linear-gradient(135deg, #F59E0B, #D97706);
  color: white;
}

.table-container {
  margin: 20px 0;
  overflow-x: auto;
  border-radius: 12px;
  border: 1px solid var(--glass-border);
}

.data-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.875rem;
}

.data-table thead {
  background: rgba(15, 23, 42, 0.8);
}

.data-table th {
  padding: 12px;
  text-align: left;
  font-weight: 600;
  color: var(--accent-cyan);
  border-bottom: 1px solid var(--glass-border);
}

.data-table td {
  padding: 10px;
  border-bottom: 1px solid var(--glass-border);
}

.data-table tbody tr:hover {
  background: rgba(0, 217, 255, 0.05);
}

.data-table input {
  padding: 8px;
  font-size: 0.8125rem;
}

.btn-add {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 10px 16px;
  background: var(--glass-bg);
  border: 1px dashed var(--glass-border);
  border-radius: 12px;
  color: var(--accent-cyan);
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.3s ease;
}

.btn-add:hover {
  background: rgba(0, 217, 255, 0.1);
  border-color: var(--accent-cyan);
  transform: translateY(-2px);
}

.remove {
  padding: 6px 10px;
  background: rgba(239, 68, 68, 0.2);
  border: 1px solid rgba(239, 68, 68, 0.4);
  border-radius: 8px;
  color: #FCA5A5;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.3s ease;
}

.remove:hover {
  background: rgba(239, 68, 68, 0.4);
  color: white;
}

.badges-display {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin: 15px 0;
  min-height: 60px;
  padding: 15px;
  background: rgba(15, 23, 42, 0.4);
  border: 1px dashed var(--glass-border);
  border-radius: 12px;
}

.badge-item {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 8px 15px;
  background: rgba(15, 23, 42, 0.6);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
  font-size: 0.8125rem;
  color: #E8EAF6;
}

.badge-item i {
  color: #FFD60A;
}

.preview-panel {
  position: sticky;
  top: 20px;
  height: fit-content;
  max-height: calc(100vh - 40px);
  overflow-y: auto;
}

.preview-panel::-webkit-scrollbar {
  width: 6px;
}

.preview-panel::-webkit-scrollbar-thumb {
  background: var(--accent-cyan);
  border-radius: 3px;
}

.report-card {
  background: linear-gradient(145deg, rgba(26, 31, 58, 0.95), rgba(15, 23, 42, 0.95));
  border: 1px solid var(--glass-border);
  border-radius: 12px;
  padding: 25px;
}

.rc-header {
  padding-bottom: 20px;
  border-bottom: 2px solid var(--glass-border);
  margin-bottom: 20px;
}

.rc-title h3 {
  font-size: 1.25rem;
  color: #E8EAF6;
  margin-bottom: 8px;
}

.rc-subtitle {
  font-size: 0.875rem;
  color: var(--accent-cyan);
}

.rc-section {
  padding: 20px;
  margin-bottom: 15px;
  background: rgba(255, 255, 255, 0.03);
  border: 1px solid var(--glass-border);
  border-radius: 12px;
}

.rc-section h4 {
  font-size: 1rem;
  color: var(--accent-cyan);
  margin-bottom: 15px;
}

.profile-display {
  display: flex;
  gap: 15px;
  align-items: center;
}

.profile-photo {
  width: 80px;
  height: 80px;
  border-radius: 12px;
  background: rgba(15, 23, 42, 0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  border: 2px solid var(--glass-border);
}

.profile-photo i {
  font-size: 2rem;
  color: #64748B;
}

.dimensions-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
  margin-bottom: 20px;
}

.dim-score {
  padding: 15px;
  background: rgba(15, 23, 42, 0.6);
  border: 1px solid var(--glass-border);
  border-radius: 12px;
  text-align: center;
}

.dim-score small {
  display: block;
  font-size: 0.75rem;
  color: #94A3B8;
  margin-bottom: 8px;
}

.score-value {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--accent-cyan);
}

.charts-container {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 15px;
  margin-top: 20px;
}

.chart-wrapper {
  padding: 15px;
  background: rgba(15, 23, 42, 0.4);
  border: 1px solid var(--glass-border);
  border-radius: 12px;
}

.footer {
  margin-top: 30px;
  padding: 20px;
  text-align: center;
  color: #64748B;
  border-top: 1px solid var(--glass-border);
}

@media (max-width: 1200px) {
  .content {
    grid-template-columns: 1fr;
  }
  
  .preview-panel {
    position: relative;
    top: 0;
    max-height: none;
  }
}

@media (max-width: 768px) {
  .form-grid.two {
    grid-template-columns: 1fr;
  }
  
  .dimension-grid {
    grid-template-columns: 1fr;
  }
  
  .profile-section {
    flex-direction: column;
  }
  
  .top-actions {
    flex-direction: column;
    width: 100%;
  }
  
  .btn {
    width: 100%;
    justify-content: center;
  }
}
  </style>
</head>
<body>
  <div class="wrap">
    <header class="top">
      <div class="header-content">
        <div class="logo-section">
          <i class="fas fa-chart-network logo-icon"></i>
          <div>
            <h1>UH-MDARC Dashboard</h1>
            <p class="muted">Universal Holistic Multi-Dimensional Assessment Report Card</p>
          </div>
        </div>
      </div>
      <div class="top-actions">
        <button id="btnPreview" class="btn primary">
          <i class="fas fa-eye"></i> Preview
        </button>
        <button id="btnDownload" class="btn secondary">
          <i class="fas fa-download"></i> Download PDF
        </button>
      </div>
    </header>

    <main class="content">
      <section class="panel form-panel">
        <h2><i class="fas fa-user-graduate"></i> Learner & Report Information</h2>

        <div class="profile-section">
          <div class="photo-upload" id="photoUpload">
            <div class="photo-overlay">
              <i class="fas fa-camera"></i>
              <span>Upload Photo</span>
            </div>
            <input type="file" id="photoInput" accept="image/*" style="display: none;">
            <img id="photoPreview" class="photo-preview" alt="Learner Photo">
          </div>
          
          <div class="profile-info">
            <div class="form-grid two">
              <div class="form-group">
                <label><i class="fas fa-user"></i> Learner Name</label>
                <input id="learnerName" type="text" placeholder="Enter full name" />
              </div>
              <div class="form-group">
                <label><i class="fas fa-fingerprint"></i> ULP Token ID</label>
                <input id="ulpToken" type="text" placeholder="ULP-0x..." />
              </div>
            </div>

            <div class="form-grid two">
              <div class="form-group">
                <label><i class="fas fa-building"></i> Community / Hub</label>
                <input id="hub" type="text" placeholder="Hub name" />
              </div>
              <div class="form-group">
                <label><i class="fas fa-id-card"></i> Learner ID</label>
                <input id="learnerId" type="text" placeholder="U-..." />
              </div>
            </div>
          </div>
        </div>

        <div class="section-divider"><span>Report Details</span></div>

        <div class="form-grid two">
          <div class="form-group">
            <label><i class="fas fa-calendar"></i> Date of Report</label>
            <input id="reportDate" type="date" />
          </div>
          <div class="form-group">
            <label><i class="fas fa-clock"></i> Reporting Period</label>
            <input id="reportPeriod" type="text" placeholder="e.g., 2025-07 — 2025-10" />
          </div>
        </div>

        <div class="form-grid two">
          <div class="form-group">
            <label><i class="fas fa-chalkboard-teacher"></i> Mentor / Evaluator</label>
            <input id="mentor" type="text" placeholder="Mentor name" />
          </div>
          <div class="form-group">
            <label><i class="fas fa-signature"></i> Digital Signature</label>
            <input id="signature" type="text" placeholder="Signer name / token" />
          </div>
        </div>

        <div class="qr-section">
          <div class="qr-code" id="qrCode">
            <span style="font-size: 10px; color: #64748B;">QR Code</span>
          </div>
          <div style="flex: 1;">
            <p style="font-size: 0.875rem; color: #CBD5E1;">The QR code encodes the ULP Token ID for instant verification and authenticity checking.</p>
          </div>
        </div>

        <div class="ulci-section">
          <h3><i class="fas fa-globe-americas"></i> Universal Life Contribution Index (ULCI)</h3>
          
          <div class="ulci-dashboard">
            <div class="ulci-badge">
              <div class="badge-icon">
                <i class="fas fa-fingerprint"></i>
              </div>
              <div class="badge-content">
                <div class="label">Index ID</div>
                <div class="value" id="ulciIdDisplay">ULCI-2025-001</div>
              </div>
            </div>
            
            <div class="ulci-badge">
              <div class="badge-icon">
                <i class="fas fa-chart-line"></i>
              </div>
              <div class="badge-content">
                <div class="label">ULCI Score</div>
                <div class="value" id="ulciScoreDisplay">0</div>
              </div>
            </div>
          </div>
          
          <div class="form-grid two">
            <div class="form-group">
              <label>ULCI Index Name</label>
              <input id="ulciName" type="text" placeholder="e.g., Global Sustainability" />
            </div>
            <div class="form-group">
              <label>ULCI Score (0-100)</label>
              <input id="ulciScore" type="number" min="0" max="100" />
            </div>
          </div>
        </div>

        <div class="section-divider"><span>Multi-Dimensional Assessment</span></div>

        <h3><i class="fas fa-layer-group"></i> Dimension Scores (0–100)</h3>
        <div class="dimension-grid">
          <div class="dimension-card">
            <div class="dimension-icon lmi">
              <i class="fas fa-graduation-cap"></i>
            </div>
            <label>LMI (Learning Mastery)</label>
            <input id="lmi" type="number" min="0" max="100" placeholder="0-100" />
          </div>
          
          <div class="dimension-card">
            <div class="dimension-icon eci">
              <i class="fas fa-heart"></i>
            </div>
            <label>ECI (Emotional Connection)</label>
            <input id="eci" type="number" min="0" max="100" placeholder="0-100" />
          </div>
          
          <div class="dimension-card">
            <div class="dimension-icon ci">
              <i class="fas fa-users"></i>
            </div>
            <label>CI (Collaborative Intelligence)</label>
            <input id="ci" type="number" min="0" max="100" placeholder="0-100" />
          </div>
          
          <div class="dimension-card">
            <div class="dimension-icon ras">
              <i class="fas fa-shield-alt"></i>
            </div>
            <label>RAS (Resilience & Adaptability)</label>
            <input id="ras" type="number" min="0" max="100" placeholder="0-100" />
          </div>
        </div>

        <div class="section-divider"><span>Competency Matrix</span></div>

        <h3><i class="fas fa-table"></i> Detailed Competency Assessment</h3>
        <div class="table-container">
          <table id="competencyTable" class="data-table">
            <thead>
              <tr>
                <th>Dimension</th>
                <th>Competency</th>
                <th>Score (1-4)</th>
                <th>Evidence</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
          <button id="addCompetency" class="btn-add">
            <i class="fas fa-plus-circle"></i> Add Competency
          </button>
        </div>

        <div class="section-divider"><span>Narrative & Reflections</span></div>

        <h3><i class="fas fa-comment-dots"></i> Holistic Feedback</h3>
        <div class="form-group">
          <label><i class="fas fa-user-edit"></i> Learner Reflection</label>
          <textarea id="learnerReflection" placeholder="Share your learning journey..."></textarea>
        </div>
        
        <div class="form-group">
          <label><i class="fas fa-chalkboard-teacher"></i> Mentor Feedback</label>
          <textarea id="mentorReflection" placeholder="Provide observations and guidance..."></textarea>
        </div>

        <div class="section-divider"><span>Development Roadmap</span></div>

        <h3><i class="fas fa-route"></i> Adaptive Learning Path</h3>
        <div class="form-group">
          <label>Short-term (1 month)</label>
          <input id="shortTerm" type="text" placeholder="Immediate next steps" />
        </div>
        
        <div class="form-group">
          <label>Medium-term (1–6 months)</label>
          <input id="mediumTerm" type="text" placeholder="Developmental goals" />
        </div>
        
        <div class="form-group">
          <label>Long-term (6+ months)</label>
          <input id="longTerm" type="text" placeholder="Aspirational objectives" />
        </div>

        <div class="section-divider"><span>Achievement Recognition</span></div>

        <h3><i class="fas fa-award"></i> Metaphormic Badges</h3>
        <div class="badges-display" id="badgesContainer"></div>
        <button id="addMetaphormicBadge" class="btn-add">
          <i class="fas fa-plus-circle"></i> Add Badge
        </button>

        <div style="margin-top: 30px; display: flex; gap: 15px;">
          <button id="btnClear" class="btn danger">
            <i class="fas fa-broom"></i> Clear Form
          </button>
        </div>
      </section>

      <aside class="panel preview-panel">
        <h2><i class="fas fa-file-alt"></i> Live Preview</h2>
        
        <div id="reportPreview" class="report-card">
          <div class="rc-header">
            <div class="rc-title">
              <h3>Universal Holistic Multi-Dimensional Assessment Report Card</h3>
              <div class="rc-subtitle">Growth + Development — UH-MDARC 360° System</div>
            </div>
            <div style="margin-top: 15px; font-size: 0.8125rem; color: #94A3B8;">
              <div><strong>ULP:</strong> <span id="pv-ulp">—</span></div>
              <div><strong>Date:</strong> <span id="pv-date">—</span></div>
            </div>
          </div>

          <section class="rc-section">
            <div class="profile-display">
              <div id="pv-photo" class="profile-photo">
                <i class="fas fa-user"></i>
              </div>
              <div style="flex: 1;">
                <div style="margin-bottom: 8px;"><strong>Name:</strong> <span id="pv-name">—</span></div>
                <div style="margin-bottom: 8px;"><strong>Hub:</strong> <span id="pv-hub">—</span></div>
                <div style="margin-bottom: 8px;"><strong>ID:</strong> <span id="pv-id">—</span></div>
                <div><strong>Mentor:</strong> <span id="pv-mentor">—</span></div>
              </div>
            </div>
          </section>

          <section class="rc-section">
            <h4>Universal Life Contribution Index</h4>
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <div>
                <div style="margin-bottom: 8px;"><strong>ID:</strong> <span id="pv-ulci-id">—</span></div>
                <div style="margin-bottom: 8px;"><strong>Score:</strong> <span id="pv-ulci-score" style="color: #00D9FF; font-weight: 700;">—</span></div>
                <div><strong>Category:</strong> <span id="pv-ulci-name">—</span></div>
              </div>
              <div id="pv-qr" style="width: 80px; height: 80px; background: white; padding: 5px; border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                <span style="font-size: 10px; color: #64748B;">QR</span>
              </div>
            </div>
          </section>

          <section class="rc-section">
            <h4>Multi-Dimensional Assessment</h4>
            <div class="dimensions-grid">
              <div class="dim-score">
                <small>LMI</small>
                <div class="score-value" id="pv-lmi">—</div>
              </div>
              <div class="dim-score">
                <small>ECI</small>
                <div class="score-value" id="pv-eci">—</div>
              </div>
              <div class="dim-score">
                <small>CI</small>
                <div class="score-value" id="pv-ci">—</div>
              </div>
              <div class="dim-score">
                <small>RAS</small>
                <div class="score-value" id="pv-ras">—</div>
              </div>
            </div>
            
            <div class="charts-container">
              <div class="chart-wrapper">
                <canvas id="pvRadar" height="150"></canvas>
              </div>
              <div class="chart-wrapper">
                <canvas id="pvTrend" height="150"></canvas>
              </div>
            </div>
          </section>

          <section class="rc-section">
            <h4>Competency Highlights</h4>
            <div id="pv-competencies" style="color: #94A3B8;">—</div>
          </section>

          <section class="rc-section">
            <h4>Holistic Narrative</h4>
            <div style="margin-bottom: 15px;">
              <strong style="color: #CBD5E1;">Learner Reflection:</strong>
              <p id="pv-learnerReflection" style="margin: 8px 0; color: #94A3B8; font-size: 0.875rem;">—</p>
            </div>
            <div>
              <strong style="color: #CBD5E1;">Mentor Feedback:</strong>
              <p id="pv-mentorReflection" style="margin: 8px 0; color: #94A3B8; font-size: 0.875rem;">—</p>
            </div>
          </section>

          <section class="rc-section">
            <h4>Development Roadmap</h4>
            <div style="display: flex; flex-direction: column; gap: 10px; font-size: 0.875rem;">
              <div><strong style="color: #3B82F6;">Short-term:</strong> <span id="pv-short" style="color: #94A3B8;">—</span></div>
              <div><strong style="color: #F59E0B;">Medium-term:</strong> <span id="pv-medium" style="color: #94A3B8;">—</span></div>
              <div><strong style="color: #10B981;">Long-term:</strong> <span id="pv-long" style="color: #94A3B8;">—</span></div>
            </div>
          </section>

          <section class="rc-section">
            <h4>Metaphormic Recognition</h4>
            <div id="pv-metaphormic-badges" style="color: #94A3B8;">—</div>
          </section>

          <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid rgba(255, 255, 255, 0.1); display: flex; justify-content: space-between; font-size: 0.8125rem; color: #94A3B8;">
            <div><strong>Signature:</strong> <span id="pv-sign">—</span></div>
            <div><span id="pv-ts"></span></div>
          </div>
          
          <div style="text-align: center; margin-top: 20px; padding-top: 15px; border-top: 1px solid rgba(255, 255, 255, 0.1); color: #475569; font-size: 0.75rem;">
            UHAN — One Earth. One Species. One Ethic.
          </div>
        </div>
      </aside>
    </main>

    <footer class="footer">
      <div>
        <i class="fas fa-globe"></i>
        <span style="margin-left: 10px;">UHAN — One Earth. One Species. One Ethic.</span>
      </div>
      <div style="margin-top: 10px;">UH-MDARC v2.0 | 360° Assessment System</div>
    </footer>
  </div>

  <script>
// Utility Functions
const $ = (id) => document.getElementById(id);
const esc = (s = '') => String(s || '').replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');

// Photo Upload
function initPhotoUpload() {
  const photoUpload = $('photoUpload');
  const photoInput = $('photoInput');
  const photoPreview = $('photoPreview');
  
  photoUpload.addEventListener('click', () => photoInput.click());
  
  photoInput.addEventListener('change', (e) => {
    const file = e.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = (e) => {
        photoPreview.src = e.target.result;
        photoPreview.classList.add('active');
        photoUpload.querySelector('.photo-overlay').style.display = 'none';
      };
      reader.readAsDataURL(file);
    }
  });
}

// QR Code Generation
function generateQRCode(text, elementId) {
  const element = $(elementId);
  if (!element || !window.QRCode) return;
  
  element.innerHTML = '';
  
  if (text) {
    const canvas = document.createElement('canvas');
    element.appendChild(canvas);
    
    QRCode.toCanvas(canvas, text, { width: 90, margin: 1 }, (error) => {
      if (error) {
        element.innerHTML = '<span style="font-size: 10px; color: #64748B;">QR Error</span>';
      }
    });
  } else {
    element.innerHTML = '<span style="font-size: 10px; color: #64748B;">QR Code</span>';
  }
}

// ULCI Update
function updateULCIDisplay() {
  const ulciName = $('ulciName').value;
  const ulciScore = $('ulciScore').value;
  
  if (ulciName || ulciScore) {
    const year = new Date().getFullYear();
    const random = Math.floor(1000 + Math.random() * 9000);
    $('ulciIdDisplay').textContent = `ULCI-${year}-${random}`;
  }
  
  if (ulciScore) {
    $('ulciScoreDisplay').textContent = ulciScore;
  }
}

// Metaphormic Badges
function initMetaphormicBadges() {
  const sampleBadges = [
    { name: 'Universal Harmony', icon: 'fas fa-globe' },
    { name: 'Cognitive Mastery', icon: 'fas fa-brain' },
    { name: 'Emotional Resonance', icon: 'fas fa-heart' }
  ];
  
  sampleBadges.forEach(badge => addMetaphormicBadge(badge.name, badge.icon));
  
  $('addMetaphormicBadge').addEventListener('click', () => {
    const name = prompt('Enter badge name:');
    if (name && name.trim()) {
      addMetaphormicBadge(name.trim(), 'fas fa-award');
    }
  });
}

function addMetaphormicBadge(name, icon) {
  const container = $('badgesContainer');
  const badge = document.createElement('div');
  badge.className = 'badge-item';
  badge.innerHTML = `<i class="${icon}"></i> ${esc(name)} <button class="remove" style="margin-left: 5px;">✕</button>`;
  
  badge.querySelector('.remove').addEventListener('click', (e) => {
    e.stopPropagation();
    badge.remove();
  });
  
  container.appendChild(badge);
}

// Create Table Rows
function createCompetencyRow(data = {}) {
  const tr = document.createElement('tr');
  tr.innerHTML = `
    <td><input class="in" data-field="dimension" value="${esc(data.dimension || '')}" placeholder="e.g., Cognitive" style="width: 100%; padding: 8px; background: rgba(15, 23, 42, 0.6); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px; color: #E8EAF6; font-size: 0.8125rem;" /></td>
    <td><input class="in" data-field="competency" value="${esc(data.competency || '')}" placeholder="e.g., Critical Thinking" style="width: 100%; padding: 8px; background: rgba(15, 23, 42, 0.6); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px; color: #E8EAF6; font-size: 0.8125rem;" /></td>
    <td><input class="in" type="number" min="1" max="4" data-field="score" value="${esc(data.score || '')}" placeholder="1-4" style="width: 100%; padding: 8px; background: rgba(15, 23, 42, 0.6); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px; color: #E8EAF6; font-size: 0.8125rem;" /></td>
    <td><input class="in" data-field="evidence" value="${esc(data.evidence || '')}" placeholder="Evidence" style="width: 100%; padding: 8px; background: rgba(15, 23, 42, 0.6); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px; color: #E8EAF6; font-size: 0.8125rem;" /></td>
    <td><button class="remove">✕</button></td>
  `;
  
  tr.querySelector('.remove').addEventListener('click', () => tr.remove());
  return tr;
}

// Charts
let radarChart = null, trendChart = null;

function createCharts(radarLabels, radarData, trendLabels, trendLMI, trendECI) {
  if (!window.Chart) return;
  
  // Radar Chart
  const rctx = $('pvRadar');
  if (rctx) {
    if (radarChart) radarChart.destroy();
    radarChart = new Chart(rctx, {
      type: 'radar',
      data: {
        labels: radarLabels,
        datasets: [{
          label: 'Profile',
          data: radarData,
          fill: true,
          backgroundColor: 'rgba(0, 217, 255, 0.15)',
          borderColor: '#00D9FF',
          pointBackgroundColor: '#00D9FF',
          pointRadius: 3
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          r: {
            suggestedMin: 0,
            suggestedMax: 100,
            angleLines: { color: 'rgba(255, 255, 255, 0.1)' },
            grid: { color: 'rgba(255, 255, 255, 0.1)' },
            pointLabels: { color: '#E8EAF6', font: { size: 10 } },
            ticks: { color: '#94A3B8', backdropColor: 'transparent' }
          }
        },
        plugins: { legend: { display: false } }
      }
    });
  }
  
  // Trend Chart
  const tctx = $('pvTrend');
  if (tctx) {
    if (trendChart) trendChart.destroy();
    trendChart = new Chart(tctx, {
      type: 'line',
      data: {
        labels: trendLabels,
        datasets: [
          {
            label: 'LMI',
            data: trendLMI,
            borderColor: '#00D9FF',
            backgroundColor: 'rgba(0, 217, 255, 0.1)',
            tension: 0.4,
            fill: true,
            pointRadius: 2
          },
          {
            label: 'ECI',
            data: trendECI,
            borderColor: '#B24BF3',
            backgroundColor: 'rgba(178, 75, 243, 0.1)',
            tension: 0.4,
            fill: true,
            pointRadius: 2
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            position: 'bottom',
            labels: { color: '#E8EAF6', padding: 8, font: { size: 10 } }
          }
        },
        scales: {
          x: {
            ticks: { color: '#94A3B8', font: { size: 9 } },
            grid: { color: 'rgba(255, 255, 255, 0.05)' }
          },
          y: {
            beginAtZero: true,
            suggestedMax: 100,
            ticks: { color: '#94A3B8', font: { size: 9 } },
            grid: { color: 'rgba(255, 255, 255, 0.05)' }
          }
        }
      }
    });
  }
}

// Render Preview
function renderPreview() {
  // Basic Info
  $('pv-name').textContent = $('learnerName').value || '—';
  $('pv-ulp').textContent = $('ulpToken').value || '—';
  $('pv-hub').textContent = $('hub').value || '—';
  $('pv-id').textContent = $('learnerId').value || '—';
  $('pv-mentor').textContent = $('mentor').value || '—';
  $('pv-date').textContent = $('reportDate').value || new Date().toISOString().slice(0, 10);
  
  // Photo
  const photoPreview = $('photoPreview');
  const pvPhoto = $('pv-photo');
  if (photoPreview.classList.contains('active')) {
    pvPhoto.innerHTML = `<img src="${photoPreview.src}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 12px;">`;
  } else {
    pvPhoto.innerHTML = '<i class="fas fa-user"></i>';
  }
  
  // ULCI
  $('pv-ulci-id').textContent = $('ulciIdDisplay').textContent || '—';
  $('pv-ulci-score').textContent = $('ulciScoreDisplay').textContent || '—';
  $('pv-ulci-name').textContent = $('ulciName').value || '—';
  
  // QR Code
  const ulpToken = $('ulpToken').value;
  if (ulpToken) {
    generateQRCode(ulpToken, 'pv-qr');
  } else {
    $('pv-qr').innerHTML = '<span style="font-size: 10px; color: #64748B;">QR</span>';
  }
  
  // Dimensions
  const lmi = Number($('lmi').value || 0);
  const eci = Number($('eci').value || 0);
  const ci = Number($('ci').value || 0);
  const ras = Number($('ras').value || 0);
  
  $('pv-lmi').textContent = lmi || '—';
  $('pv-eci').textContent = eci || '—';
  $('pv-ci').textContent = ci || '—';
  $('pv-ras').textContent = ras || '—';
  
  // Charts Data
  const competencyRows = Array.from(document.querySelectorAll('#competencyTable tbody tr'));
  const dimensionMap = {};
  
  competencyRows.forEach(tr => {
    const dim = tr.querySelector('[data-field="dimension"]').value.trim() || 'Other';
    const score = Number(tr.querySelector('[data-field="score"]').value || 0);
    
    if (!dimensionMap[dim]) dimensionMap[dim] = [];
    if (score > 0) dimensionMap[dim].push(score * 25);
  });
  
  const radarLabels = Object.keys(dimensionMap).length ? Object.keys(dimensionMap) : ['Cognitive', 'Character', 'Practical', 'Collaboration'];
  const radarValues = radarLabels.map(label => {
    const scores = dimensionMap[label] || [];
    return scores.length ? Math.round(scores.reduce((a, b) => a + b, 0) / scores.length) : 50;
  });
  
  const trendLabels = ['May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct'];
  const baseLMI = Math.max(10, Math.min(100, lmi || 50));
  const baseECI = Math.max(10, Math.min(100, eci || 50));
  const trendLMI = trendLabels.map((_, i) => Math.round(baseLMI - 10 + (i * 4)));
  const trendECI = trendLabels.map((_, i) => Math.round(baseECI - 8 + (i * 3)));
  
  createCharts(radarLabels, radarValues, trendLabels, trendLMI, trendECI);
  
  // Competencies
  const pvComp = $('pv-competencies');
  pvComp.innerHTML = '';
  
  if (competencyRows.length === 0) {
    pvComp.textContent = '—';
  } else {
    competencyRows.forEach(tr => {
      const comp = tr.querySelector('[data-field="competency"]').value || 'Competency';
      const score = tr.querySelector('[data-field="score"]').value || '';
      const evidence = tr.querySelector('[data-field="evidence"]').value || '';
      
      const item = document.createElement('div');
      item.style.marginBottom = '12px';
      item.style.padding = '10px';
      item.style.background = 'rgba(15, 23, 42, 0.4)';
      item.style.borderRadius = '8px';
      item.style.borderLeft = '3px solid #00D9FF';
      item.innerHTML = `
        <strong style="color: #E8EAF6;">${esc(comp)}</strong> — Score: ${esc(score)}/4
        <div style="font-size: 0.8125rem; color: #94A3B8; margin-top: 4px;">${esc(evidence)}</div>
      `;
      pvComp.appendChild(item);
    });
  }
  
  // Narrative
  $('pv-learnerReflection').textContent = $('learnerReflection').value || '—';
  $('pv-mentorReflection').textContent = $('mentorReflection').value || '—';
  
  // Path
  $('pv-short').textContent = $('shortTerm').value || '—';
  $('pv-medium').textContent = $('mediumTerm').value || '—';
  $('pv-long').textContent = $('longTerm').value || '—';
  
  // Badges
  const mbadges = Array.from(document.querySelectorAll('#badgesContainer .badge-item'));
  const pvMBadges = $('pv-metaphormic-badges');
  pvMBadges.innerHTML = '';
  
  if (mbadges.length === 0) {
    pvMBadges.textContent = '—';
  } else {
    mbadges.forEach(badge => {
      const text = badge.textContent.replace('✕', '').trim();
      const icon = badge.querySelector('i').className;
      const item = document.createElement('div');
      item.style.display = 'inline-block';
      item.style.margin = '5px';
      item.style.padding = '6px 12px';
      item.style.background = 'rgba(15, 23, 42, 0.6)';
      item.style.borderRadius = '20px';
      item.style.fontSize = '0.8125rem';
      item.innerHTML = `<i class="${icon}" style="color: #FFD60A;"></i> ${esc(text)}`;
      pvMBadges.appendChild(item);
    });
  }
  
  // Signature & Timestamp
  $('pv-sign').textContent = $('signature').value || '—';
  $('pv-ts').textContent = new Date().toLocaleString();
}

// PDF Export
async function downloadPDF() {
  if (!window.html2canvas || !window.jspdf) {
    alert('PDF libraries not loaded. Please refresh the page.');
    return;
  }
  
  try {
    renderPreview();
    
    const reportElement = $('reportPreview');
    const canvas = await html2canvas(reportElement, {
      scale: 2,
      useCORS: true,
      logging: false,
      backgroundColor: '#1A1F3A'
    });
    
    const imgData = canvas.toDataURL('image/png');
    const { jsPDF } = window.jspdf;
    
    const imgWidth = 210;
    const pageHeight = 297;
    const imgHeight = (canvas.height * imgWidth) / canvas.width;
    
    const pdf = new jsPDF('p', 'mm', 'a4');
    pdf.addImage(imgData, 'PNG', 0, 0, imgWidth, imgHeight);
    
    const learnerName = $('learnerName').value || 'Learner';
    const date = new Date().toISOString().slice(0, 10);
    const filename = `UH-MDARC_${learnerName.replace(/\s+/g, '_')}_${date}.pdf`;
    
    pdf.save(filename);
    alert('PDF downloaded successfully!');
  } catch (error) {
    console.error('PDF Error:', error);
    alert('Failed to generate PDF. Please try again.');
  }
}

// Clear Form
function clearForm() {
  if (!confirm('Clear all form data?')) return;
  
  document.querySelectorAll('input[type="text"], input[type="date"], input[type="number"], textarea').forEach(i => i.value = '');
  document.querySelector('#competencyTable tbody').innerHTML = '';
  $('badgesContainer').innerHTML = '';
  
  const photoPreview = $('photoPreview');
  photoPreview.src = '';
  photoPreview.classList.remove('active');
  $('photoInput').value = '';
  $('photoUpload').querySelector('.photo-overlay').style.display = 'flex';
  
  $('qrCode').innerHTML = '<span style="font-size: 10px; color: #64748B;">QR Code</span>';
  $('ulciIdDisplay').textContent = 'ULCI-2025-001';
  $('ulciScoreDisplay').textContent = '0';
  
  // Add default rows
  const tbody = document.querySelector('#competencyTable tbody');
  tbody.appendChild(createCompetencyRow({
    dimension: 'Cognitive',
    competency: 'Evidence Synthesis',
    score: '3',
    evidence: 'Research project demonstrated thorough validation'
  }));
  tbody.appendChild(createCompetencyRow({
    dimension: 'Character',
    competency: 'Adaptive Resilience',
    score: '2',
    evidence: 'Actively requested peer feedback'
  }));
  
  initMetaphormicBadges();
  renderPreview();
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
  console.log('UH-MDARC Dashboard Loading...');
  
  // Set current date
  $('reportDate').valueAsDate = new Date();
  
  // Initialize components
  initPhotoUpload();
  initMetaphormicBadges();
  
  // Event Listeners
  $('ulciName').addEventListener('input', updateULCIDisplay);
  $('ulciScore').addEventListener('input', updateULCIDisplay);
  $('ulpToken').addEventListener('input', () => generateQRCode($('ulpToken').value, 'qrCode'));
  
  $('addCompetency').addEventListener('click', () => {
    document.querySelector('#competencyTable tbody').appendChild(createCompetencyRow());
  });
  
  $('btnPreview').addEventListener('click', renderPreview);
  $('btnDownload').addEventListener('click', downloadPDF);
  $('btnClear').addEventListener('click', clearForm);
  
  // Add input listeners for auto-preview
  document.querySelectorAll('input, textarea').forEach(input => {
    input.addEventListener('input', () => {
      setTimeout(renderPreview, 300);
    });
  });
  
  // Initialize sample data
  const tbody = document.querySelector('#competencyTable tbody');
  tbody.appendChild(createCompetencyRow({
    dimension: 'Cognitive',
    competency: 'Evidence Synthesis',
    score: '3',
    evidence: 'Research project demonstrated thorough validation'
  }));
  tbody.appendChild(createCompetencyRow({
    dimension: 'Character',
    competency: 'Adaptive Resilience',
    score: '2',
    evidence: 'Actively requested peer feedback'
  }));
  
  updateULCIDisplay();
  renderPreview();
  
  console.log('✅ UH-MDARC Dashboard Ready!');
});
  </script>
</body>
</html>
