<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UNETS Admin Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Playfair+Display:wght@700&family=Montserrat:wght@400;500;600;700&family=Orbitron:wght@700;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #667eea;
            --navy: #1e3a8a;
            --gold: #d4af37;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .top-navbar {
            background: white;
            padding: 12px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .navbar-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .navbar-brand {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary);
            text-decoration: none;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
        }
        
        .hamburger-menu {
            width: 40px;
            height: 40px;
            background: transparent;
            border: none;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 5px;
        }
        
        .hamburger-line {
            width: 25px;
            height: 3px;
            background: var(--primary);
            border-radius: 3px;
        }
        
        .sidebar {
            position: fixed;
            top: 0;
            right: -320px;
            width: 320px;
            height: 100vh;
            background: white;
            box-shadow: -5px 0 15px rgba(0,0,0,0.2);
            transition: right 0.3s;
            z-index: 1001;
            overflow-y: auto;
        }
        
        .sidebar.active { right: 0; }
        
        .sidebar-header {
            background: linear-gradient(135deg, var(--primary), #764ba2);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
        }
        
        .close-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
        }
        
        .sidebar-menu {
            list-style: none;
            padding: 0;
        }
        
        .sidebar-menu li a {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px 20px;
            color: #333;
            text-decoration: none;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            z-index: 1000;
        }
        
        .sidebar-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .form-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 20px;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
        }
        
        .form-group label {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }
        
        .form-control {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 0.9rem;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .signature-section {
            margin-top: 20px;
            padding: 20px;
            background: rgba(102,126,234,0.05);
            border-radius: 8px;
        }
        
        #signaturePad {
            border: 2px solid #ddd;
            border-radius: 8px;
            background: white;
            cursor: crosshair;
            width: 100%;
            max-width: 400px;
            height: 150px;
        }
        
        .btn-submit {
            background: linear-gradient(135deg, var(--primary), #764ba2);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            font-size: 1rem;
            width: 100%;
            margin-top: 20px;
        }
        
        .certificate-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .certificate-wrapper {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            overflow-x: auto;
            padding: 20px;
        }
        
        /* A4 Certificate - 210mm x 297mm */
        .certificate-a4 {
            width: 210mm;
            height: 297mm;
            background: linear-gradient(135deg, #fffbf0 0%, #fff9e6 100%);
            position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            padding: 10mm;
        }
        
        .cert-border {
            border: 3mm double var(--gold);
            height: 100%;
            padding: 8mm;
            display: flex;
            flex-direction: column;
        }
        
        /* Header with 3 columns */
        .cert-header {
            display: grid;
            grid-template-columns: 15mm 1fr 25mm;
            gap: 3mm;
            align-items: center;
            border-bottom: 1.5px solid var(--gold);
            padding-bottom: 4mm;
            margin-bottom: 4mm;
        }
        
        .header-left {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .cert-logo {
            font-size: 20pt;
        }
        
        .header-center {
            text-align: center;
        }
        
        .header-center h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 12pt;
            font-weight: 900;
            color: var(--navy);
            margin-bottom: 1.5mm;
            line-height: 1.1;
        }
        
        .header-center h2 {
            font-size: 7pt;
            color: var(--navy);
            font-weight: 600;
            margin-bottom: 1mm;
        }
        
        .header-center h3 {
            font-size: 6pt;
            color: #000;
            font-weight: 500;
        }
        
        .header-right {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1mm;
        }
        
        .qr-code {
            width: 18mm;
            height: 18mm;
            background: white;
            border: 1px solid var(--navy);
            border-radius: 2mm;
        }
        
        .ulc-small-text {
            font-size: 4pt;
            color: var(--navy);
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            text-align: center;
            word-break: break-all;
            line-height: 1.1;
        }
        
        /* Title */
        .cert-title {
            font-family: 'Cinzel', serif;
            font-size: 18pt;
            font-weight: 700;
            text-align: center;
            color: var(--gold);
            margin: 4mm 0 2mm 0;
            letter-spacing: 2pt;
            text-transform: uppercase;
        }
        
        .badge-text {
            text-align: center;
            font-size: 7pt;
            color: var(--navy);
            font-weight: 600;
            margin-bottom: 3mm;
        }
        
        /* Body */
        .cert-body {
            text-align: center;
            flex: 1;
        }
        
        .cert-body p {
            font-size: 7pt;
            color: #000;
            margin: 1.5mm 0;
            line-height: 1.3;
        }
        
        .learner-name {
            font-family: 'Playfair Display', serif;
            font-size: 20pt;
            font-weight: 700;
            color: var(--navy);
            margin: 2mm 0;
            border-bottom: 2px solid var(--navy);
            display: inline-block;
            padding-bottom: 1mm;
        }
        
        .info-line {
            font-size: 7pt;
            color: #000;
            font-weight: 500;
            margin: 1.5mm 0;
        }
        
        .info-line strong {
            color: var(--navy);
            font-weight: 700;
        }
        
        /* IDs Grid */
        .ids-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 2mm;
            margin: 3mm 0;
            padding: 2mm;
            background: rgba(30, 58, 138, 0.05);
            border-radius: 2mm;
        }
        
        .id-box {
            text-align: center;
            padding: 1.5mm;
        }
        
        .id-label {
            font-size: 5pt;
            color: var(--navy);
            font-weight: 700;
            display: block;
            margin-bottom: 1mm;
        }
        
        .id-value {
            font-size: 6pt;
            color: #000;
            font-family: 'Orbitron', monospace;
            font-weight: 600;
            word-break: break-all;
        }
        
        .program-title {
            font-size: 11pt;
            font-weight: 700;
            color: var(--navy);
            margin: 2mm 0;
            font-style: italic;
        }
        
        .cycle-text {
            font-size: 6pt;
            color: #666;
            font-style: italic;
            margin: 1.5mm 0;
        }
        
        /* Domains Grid */
        .domains-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 2mm;
            margin: 3mm 0;
        }
        
        .domain-box {
            text-align: center;
            padding: 2mm;
            border: 1px solid var(--gold);
            border-radius: 2mm;
            background: rgba(212, 175, 55, 0.05);
        }
        
        .domain-label {
            font-size: 6pt;
            color: var(--navy);
            font-weight: 700;
            display: block;
            margin-bottom: 1mm;
        }
        
        .domain-score {
            font-size: 11pt;
            color: var(--gold);
            font-weight: 700;
        }
        
        /* Footer */
        .cert-footer {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            margin-top: 4mm;
            padding-top: 3mm;
            border-top: 1.5px solid var(--gold);
        }
        
        .footer-left {
            text-align: left;
        }
        
        .footer-left p {
            font-size: 6pt;
            color: #000;
            margin-bottom: 1.5mm;
        }
        
        .signature-line {
            border-bottom: 1.5px solid #000;
            width: 35mm;
            height: 10mm;
            margin-bottom: 1mm;
        }
        
        .verifier-name {
            font-family: 'Playfair Display', serif;
            font-size: 9pt;
            color: var(--navy);
            font-weight: 700;
            margin-bottom: 1mm;
        }
        
        .footer-right {
            text-align: right;
        }
        
        .authority-badge {
            background: var(--navy);
            color: white;
            padding: 2mm 4mm;
            border-radius: 2mm;
            font-weight: 700;
            font-size: 7pt;
            display: inline-block;
            margin-bottom: 1.5mm;
        }
        
        .footer-right p {
            font-size: 5pt;
            color: #000;
            margin: 0.5mm 0;
        }
        
        @media print {
            body * { visibility: hidden; }
            .certificate-a4, .certificate-a4 * { visibility: visible; }
            .certificate-a4 {
                position: fixed;
                left: 0;
                top: 0;
                margin: 0;
                box-shadow: none;
            }
        }
        
        @media (max-width: 768px) {
            .certificate-a4 {
                transform: scale(0.35);
                transform-origin: top center;
            }
        }
    </style>
</head>
<body>
    <nav class="top-navbar">
        <div class="navbar-content">
            <a href="#" class="navbar-brand">
                <i class="fas fa-graduation-cap"></i> UNETS Admin
            </a>
            <div style="display:flex;gap:15px;align-items:center;">
                <div class="user-avatar">AD</div>
                <button class="hamburger-menu" id="hamburgerBtn">
                    <span class="hamburger-line"></span>
                    <span class="hamburger-line"></span>
                    <span class="hamburger-line"></span>
                </button>
            </div>
        </div>
    </nav>

    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h3>Menu</h3>
            <button class="close-btn" id="closeBtn">&times;</button>
        </div>
        <ul class="sidebar-menu">
            <li><a href="#"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
            <li><a href="#"><i class="fas fa-certificate"></i> Certificates</a></li>
            <li><a href="#"><i class="fas fa-users"></i> Learners</a></li>
            <li><a href="#"><i class="fas fa-cogs"></i> Settings</a></li>
        </ul>
    </div>
    <div class="sidebar-overlay" id="overlay"></div>

    <div class="main-content">
        <div class="form-section">
            <h2 class="section-title"><i class="fas fa-edit"></i> Certificate Data Entry (Manual)</h2>
            <form id="certificateForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label>Learner Name *</label>
                        <input type="text" class="form-control" id="learnerName" placeholder="Enter learner full name" required>
                    </div>
                    <div class="form-group">
                        <label>Date of Birth *</label>
                        <input type="text" class="form-control" id="dateOfBirth" placeholder="DD/MM/YYYY" required>
                    </div>
                    <div class="form-group">
                        <label>Parent/Guardian Name *</label>
                        <input type="text" class="form-control" id="parentName" placeholder="Enter parent name" required>
                    </div>
                    <div class="form-group">
                        <label>Place Name *</label>
                        <input type="text" class="form-control" id="placeName" placeholder="City, State" required>
                    </div>
                    <div class="form-group">
                        <label>Institution/Hub Name *</label>
                        <input type="text" class="form-control" id="institution" placeholder="Enter institution name" required>
                    </div>
                    <div class="form-group">
                        <label>Program Title *</label>
                        <input type="text" class="form-control" id="programTitle" placeholder="Enter program title" required>
                    </div>
                    <div class="form-group">
                        <label>Badge Name *</label>
                        <input type="text" class="form-control" id="badgeName" placeholder="Enter badge name" required>
                    </div>
                    <div class="form-group">
                        <label>ULP ID</label>
                        <input type="text" class="form-control" id="ulpId" placeholder="ULP-2025-XXXX">
                    </div>
                    <div class="form-group">
                        <label>ULC ID *</label>
                        <input type="text" class="form-control" id="ulcId" placeholder="ULC-2025-XXXX" required>
                    </div>
                    <div class="form-group">
                        <label>ULCI ID</label>
                        <input type="text" class="form-control" id="ulciId" placeholder="ULCI-2025-XXXX">
                    </div>
                    <div class="form-group">
                        <label>ULCI Score</label>
                        <input type="text" class="form-control" id="ulciScore" placeholder="95% or A+ or Excellent">
                    </div>
                    <div class="form-group">
                        <label>Index Level</label>
                        <input type="text" class="form-control" id="indexLevel" placeholder="Level 1, Level 2, etc.">
                    </div>
                    <div class="form-group">
                        <label>Knowledge & Inquiry Score</label>
                        <input type="text" class="form-control" id="knowledgeScore" placeholder="95%, A+, Excellent, etc.">
                    </div>
                    <div class="form-group">
                        <label>Creativity & Innovation</label>
                        <input type="text" class="form-control" id="creativity" placeholder="Advanced, Excellent, 90%, etc.">
                    </div>
                    <div class="form-group">
                        <label>Collaboration & Compassion</label>
                        <input type="text" class="form-control" id="collaboration" placeholder="88%, Good, High, etc.">
                    </div>
                    <div class="form-group">
                        <label>Leadership & Contribution</label>
                        <input type="text" class="form-control" id="leadership" placeholder="High Impact, Excellent, etc.">
                    </div>
                    <div class="form-group">
                        <label>Date Issued</label>
                        <input type="text" class="form-control" id="dateIssued" placeholder="DD/MM/YYYY or November 5, 2025">
                    </div>
                    <div class="form-group">
                        <label>Verified By (Mentor Name)</label>
                        <input type="text" class="form-control" id="verifiedBy" placeholder="Enter mentor/verifier name">
                    </div>
                </div>
                
                <div class="signature-section">
                    <h4><i class="fas fa-pen-nib"></i> Digital Signature</h4>
                    <canvas id="signaturePad"></canvas>
                    <div style="margin-top:10px;">
                        <button type="button" class="btn-submit" id="clearSig" style="width:auto;padding:8px 20px;background:#dc3545;">Clear</button>
                        <button type="button" class="btn-submit" id="saveSig" style="width:auto;padding:8px 20px;background:#28a745;margin-left:10px;">Save</button>
                    </div>
                </div>
                
                <button type="submit" class="btn-submit">
                    <i class="fas fa-save"></i> Generate Certificate
                </button>
            </form>
        </div>

        <div class="certificate-section">
            <h2 class="section-title"><i class="fas fa-certificate"></i> Certificate Preview</h2>
            <div class="certificate-wrapper">
                <div class="certificate-a4" id="certificate">
                    <div class="cert-border">
                        <!-- Header: Logo Left, Text Center, QR Right -->
                        <div class="cert-header">
                            <div class="header-left">
                                <div class="cert-logo">ðŸŒŽ</div>
                            </div>
                            
                            <div class="header-center">
                                <h1>UNIVERSAL NEXUS EDUCATION<br>TRANSFORMATION SYSTEM</h1>
                                <h2>"Education for the Universal Nexus Human Civilization 3.0"</h2>
                                <h3>Education 5.0 Â· Lifelong Learning Â· Scientific Humanism</h3>
                            </div>
                            
                            <div class="header-right">
                                <div class="qr-code" id="qrCode"></div>
                                <div class="ulc-small-text" id="ulcSmall">ULC-2025-XXXX</div>
                            </div>
                        </div>
                        
                        <!-- Title -->
                        <div class="cert-title">CERTIFICATE OF ACHIEVEMENT</div>
                        <div class="badge-text" id="badgeText">Metamorphic Badge: [Badge Name]</div>
                        
                        <!-- Body -->
                        <div class="cert-body">
                            <p>This certifies that</p>
                            <div class="learner-name" id="certName">[Learner Name]</div>
                            
                            <p class="info-line"><strong>Date of Birth:</strong> <span id="certDob">[DD/MM/YYYY]</span></p>
                            <p class="info-line"><strong>Parent/Guardian:</strong> <span id="certParent">[Parent Name]</span></p>
                            <p class="info-line"><strong>Institution:</strong> <span id="certInst">[Institution]</span></p>
                            <p class="info-line"><strong>Place:</strong> <span id="certPlace">[Place Name]</span></p>
                            
                            <!-- IDs Grid -->
                            <div class="ids-grid">
                                <div class="id-box">
                                    <span class="id-label">ULP ID</span>
                                    <div class="id-value" id="idUlp">ULP-2025-XXX</div>
                                </div>
                                <div class="id-box">
                                    <span class="id-label">ULC ID</span>
                                    <div class="id-value" id="idUlc">ULC-2025-XXX</div>
                                </div>
                                <div class="id-box">
                                    <span class="id-label">ULCI ID</span>
                                    <div class="id-value" id="idUlci">ULCI-2025-XXX</div>
                                </div>
                                <div class="id-box">
                                    <span class="id-label">ULCI Score</span>
                                    <div class="id-value" id="scoreUlci">95%</div>
                                </div>
                                <div class="id-box">
                                    <span class="id-label">Index Level</span>
                                    <div class="id-value" id="levelIndex">Level 1</div>
                                </div>
                            </div>
                            
                            <p>has successfully completed the program</p>
                            <div class="program-title" id="certProgram">"[Program Title]"</div>
                            <p class="cycle-text">under the Education 5.0 â€” Discovery â†’ Integration â†’ Creation â†’ Contribution Cycle</p>
                            
                            <!-- Domains -->
                            <div class="domains-grid">
                                <div class="domain-box">
                                    <span class="domain-label">Knowledge & Inquiry</span>
                                    <div class="domain-score" id="scoreKnow">95%</div>
                                </div>
                                <div class="domain-box">
                                    <span class="domain-label">Creativity & Innovation</span>
                                    <div class="domain-score" id="scoreCreat">Advanced</div>
                                </div>
                                <div class="domain-box">
                                    <span class="domain-label">Collaboration & Compassion</span>
                                    <div class="domain-score" id="scoreCollab">88%</div>
                                </div>
                                <div class="domain-box">
                                    <span class="domain-label">Leadership & Contribution</span>
                                    <div class="domain-score" id="scoreLead">High Impact</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Footer -->
                        <div class="cert-footer">
                            <div class="footer-left">
                                <p><strong>Issued on:</strong> <span id="certDate">November 5, 2025</span></p>
                                <canvas class="signature-line" id="certSig" width="130" height="38"></canvas>
                                <div class="verifier-name" id="certVerifier">[Mentor Name]</div>
                                <p style="font-size:5pt;">Authorized Verifier</p>
                            </div>
                            <div class="footer-right">
                                <div class="authority-badge">Authorized by UIENC</div>
                                <p><strong>Credential ID:</strong> <span id="credId">UNETS-CERT-XXX</span></p>
                                <p style="color:#1e3a8a;font-weight:700;">verify.education.onsnc.org</p>
                                <p><strong>www.education.onsnc.org</strong></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div style="text-align:center;margin-top:20px;">
                <button class="btn-submit" id="downloadBtn" style="width:auto;padding:12px 40px;">
                    <i class="fas fa-download"></i> Download PDF
                </button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    
    <script>
        // Menu
        document.getElementById('hamburgerBtn').addEventListener('click', () => {
            document.getElementById('sidebar').classList.add('active');
            document.getElementById('overlay').classList.add('active');
        });
        
        const closeSidebar = () => {
            document.getElementById('sidebar').classList.remove('active');
            document.getElementById('overlay').classList.remove('active');
        };
        
        document.getElementById('closeBtn').addEventListener('click', closeSidebar);
        document.getElementById('overlay').addEventListener('click', closeSidebar);
        
        // QR Code
        function generateQR(ulcId) {
            const qrDiv = document.getElementById('qrCode');
            qrDiv.innerHTML = '';
            try {
                new QRCode(qrDiv, {
                    text: `https://verify.education.onsnc.org/${ulcId}`,
                    width: 68,
                    height: 68,
                    colorDark: '#1e3a8a',
                    colorLight: '#ffffff'
                });
            } catch(e) {
                qrDiv.innerHTML = '<div style="padding:20px;font-size:8px;">QR</div>';
            }
        }
        
        // Signature Pad
        let savedSignature = null;
        const sigPad = document.getElementById('signaturePad');
        const sigCtx = sigPad.getContext('2d');
        let drawing = false;
        
        function startDraw(e) {
            drawing = true;
            const rect = sigPad.getBoundingClientRect();
            const x = (e.clientX || e.touches[0].clientX) - rect.left;
            const y = (e.clientY || e.touches[0].clientY) - rect.top;
            sigCtx.beginPath();
            sigCtx.moveTo(x, y);
        }
        
        function draw(e) {
            if (!drawing) return;
            e.preventDefault();
            const rect = sigPad.getBoundingClientRect();
            const x = (e.clientX || e.touches[0].clientX) - rect.left;
            const y = (e.clientY || e.touches[0].clientY) - rect.top;
            sigCtx.lineTo(x, y);
            sigCtx.strokeStyle = '#1e3a8a';
            sigCtx.lineWidth = 2;
            sigCtx.lineCap = 'round';
            sigCtx.stroke();
        }
        
        function stopDraw() {
            drawing = false;
        }
        
        sigPad.addEventListener('mousedown', startDraw);
        sigPad.addEventListener('mousemove', draw);
        sigPad.addEventListener('mouseup', stopDraw);
        sigPad.addEventListener('touchstart', startDraw);
        sigPad.addEventListener('touchmove', draw);
        sigPad.addEventListener('touchend', stopDraw);
        
        document.getElementById('clearSig').addEventListener('click', () => {
            sigCtx.clearRect(0, 0, sigPad.width, sigPad.height);
        });
        
        document.getElementById('saveSig').addEventListener('click', () => {
            savedSignature = sigPad.toDataURL();
            const certSig = document.getElementById('certSig');
            const certCtx = certSig.getContext('2d');
            const img = new Image();
            img.onload = () => {
                certCtx.clearRect(0, 0, certSig.width, certSig.height);
                certCtx.drawImage(img, 0, 0, certSig.width, certSig.height);
            };
            img.src = savedSignature;
            alert('âœ“ Signature saved!');
        });
        
        // Update Preview
        function updatePreview() {
            const ulcId = document.getElementById('ulcId').value || 'ULC-2025-XXXX';
            
            document.getElementById('ulcSmall').textContent = ulcId;
            document.getElementById('badgeText').textContent = `Metamorphic Badge: ${document.getElementById('badgeName').value || '[Badge Name]'}`;
            document.getElementById('certName').textContent = document.getElementById('learnerName').value || '[Learner Name]';
            document.getElementById('certDob').textContent = document.getElementById('dateOfBirth').value || '[DD/MM/YYYY]';
            document.getElementById('certParent').textContent = document.getElementById('parentName').value || '[Parent Name]';
            document.getElementById('certInst').textContent = document.getElementById('institution').value || '[Institution]';
            document.getElementById('certPlace').textContent = document.getElementById('placeName').value || '[Place Name]';
            document.getElementById('certProgram').textContent = `"${document.getElementById('programTitle').value || '[Program Title]'}"`;
            
            document.getElementById('idUlp').textContent = document.getElementById('ulpId').value || 'ULP-2025-XXX';
            document.getElementById('idUlc').textContent = ulcId;
            document.getElementById('idUlci').textContent = document.getElementById('ulciId').value || 'ULCI-2025-XXX';
            document.getElementById('scoreUlci').textContent = document.getElementById('ulciScore').value || '95%';
            document.getElementById('levelIndex').textContent = document.getElementById('indexLevel').value || 'Level 1';
            
            document.getElementById('scoreKnow').textContent = document.getElementById('knowledgeScore').value || '95%';
            document.getElementById('scoreCreat').textContent = document.getElementById('creativity').value || 'Advanced';
            document.getElementById('scoreCollab').textContent = document.getElementById('collaboration').value || '88%';
            document.getElementById('scoreLead').textContent = document.getElementById('leadership').value || 'High Impact';
            
            document.getElementById('certDate').textContent = document.getElementById('dateIssued').value || 'November 5, 2025';
            document.getElementById('certVerifier').textContent = document.getElementById('verifiedBy').value || '[Mentor Name]';
            document.getElementById('credId').textContent = `UNETS-CERT-2025-${Date.now().toString().slice(-9)}`;
            
            generateQR(ulcId);
        }
        
        // Form Submit
        document.getElementById('certificateForm').addEventListener('submit', (e) => {
            e.preventDefault();
            
            if (!document.getElementById('learnerName').value) {
                alert('âš  Please enter learner name');
                return;
            }
            
            if (!document.getElementById('ulcId').value) {
                alert('âš  Please enter ULC ID');
                return;
            }
            
            updatePreview();
            alert('âœ“ Certificate generated successfully!');
            
            setTimeout(() => {
                document.querySelector('.certificate-section').scrollIntoView({behavior:'smooth'});
            }, 300);
        });
        
        // PDF Download
        document.getElementById('downloadBtn').addEventListener('click', async () => {
            const btn = document.getElementById('downloadBtn');
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating...';
            
            try {
                await new Promise(resolve => setTimeout(resolve, 500));
                
                const cert = document.getElementById('certificate');
                
                const canvas = await html2canvas(cert, {
                    scale: 3,
                    useCORS: true,
                    backgroundColor: '#fffbf0',
                    width: 794,
                    height: 1123,
                    logging: false
                });
                
                const imgData = canvas.toDataURL('image/png', 1.0);
                
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF({
                    orientation: 'portrait',
                    unit: 'mm',
                    format: 'a4',
                    compress: true
                });
                
                pdf.addImage(imgData, 'PNG', 0, 0, 210, 297);
                
                const name = document.getElementById('learnerName').value.replace(/[^a-zA-Z0-9]/g, '_') || 'Certificate';
                const ulcId = document.getElementById('ulcId').value.replace(/[^a-zA-Z0-9]/g, '_') || 'ULC';
                pdf.save(`ULC_Certificate_${name}_${ulcId}.pdf`);
                
                alert('âœ“ PDF Downloaded Successfully!\n\nA4 Size: 210mm Ã— 297mm');
            } catch(error) {
                console.error('Error:', error);
                alert('âš  Error generating PDF. Please try again.');
            } finally {
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-download"></i> Download PDF';
            }
        });
        
        // Auto-update on input
        document.querySelectorAll('#certificateForm input').forEach(input => {
            input.addEventListener('input', () => {
                clearTimeout(window.updateTimer);
                window.updateTimer = setTimeout(updatePreview, 300);
            });
        });
        
        // Initialize
        updatePreview();
        
        console.log('âœ“ UNETS System Ready');
        console.log('âœ“ Manual Entry Mode - No Dropdowns');
        console.log('âœ“ Certificate: 210mm Ã— 297mm A4');
        console.log('âœ“ Logo Left | Text Center | QR Right');
        console.log('âœ“ Small Text Sizes Applied');
    </script>
</body>
</html>
